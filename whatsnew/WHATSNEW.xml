<?xml version="1.0" standalone="no"?>

<!-- catalog not working ? -->
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook-Interchange XML V4.2//EN"
	"../docbook/docbookxi.dtd">

<article id='WHATSNEW'>

<articleinfo>
	<title>Interchange Misc: WHATSNEW entries</title>
	<titleabbrev>whatsnew</titleabbrev>

	<copyright>
		<year>2006</year>
		<holder>Interchange Development Group</holder>
	</copyright>

	<legalnotice>
		<para>
		This documentation is free; you can redistribute it and/or modify
		it under the terms of the &GNU; General Public License as published by
		the Free Software Foundation; either version 2 of the License, or
		(at your option) any later version.
		</para>
		<para>
		It is distributed in the hope that it will be useful,
		but WITHOUT ANY WARRANTY; without even the implied warranty of
		MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
		GNU General Public License for more details.
		</para>
	</legalnotice>

	<abstract>
		<para>
		This document serves as a convenient source of "What's new?"
		&IC; information.
		</para><para>
		The entries found here are just excerpts from our &ICCVS; commit
		messages.
		</para><para>
		You could subscribe to the 
		<ulink url='http://www.icdevgroup.org/mailman/listinfo/interchange-cvs'>Interchange CVS</ulink> mailing list to receive complete commit logs (changes in &IC; codebase) to your e-mail.
		</para><para>
		You can also browse public
		<ulink url='http://www.icdevgroup.org/pipermail/interchange-cvs/'>interchange-cvs
		mailing list archives</ulink> over the Web.
		</para>
	</abstract>
</articleinfo>

<section id="WHATSNEW-5.5">
	<title>INTERCHANGE 5.5 (development) and the upcoming 6.0 (stable)</title>
<!-- must be on a line itself, no spaces -->
<!-- AUTO UPDATER -->
<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-27 14:14:41 GMT
Modified:  dist/standard/products locale.txt</emphasis>
get rid of price_picture, introduced int_currency_symbol and use HTML euro symbol
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-27 14:16:39 GMT
Modified:  dist/standard/etc report</emphasis>
use new display option for report
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-21 22:05:03 GMT
Modified:  dist/standard/dbconf/mysql mysql.cfg</emphasis>
varchar(255) makes much more sense as default type than char(128), columns
subject to indexing can be specified explicitly in individual *.mysql files
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-23 15:17:09 GMT
Modified:  dist/lib/UI/pages/admin content.html</emphasis>
improved spacing, new page is longer sticking directly below title bar
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-03-27 18:42:50 GMT
Modified:  lib/Vend Interpolate.pm</emphasis>
Remove legacy [/page] and [/order] macros.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-26 20:43:37 GMT
Modified:  dist/standard/products locale.txt</emphasis>
added German translation for front page info
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-21 21:20:07 GMT
Modified:  dist/standard/dbconf/mysql country.mysql</emphasis>
increase size of name field so that all country names fit, patch from Gert van der Spoel
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: kwalsh
Date: 2006-03-21 14:50:45 GMT
Modified:  scripts  expire.PL</emphasis>
    * Added the missing &quot;use Vend::Dispatch&quot; directive to prevent the
      &quot;Undefined subroutine &amp;Vend::Dispatch::update_global_actions&quot;
      error reported by Andreas Grau.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-03-14 19:17:21 GMT
Modified:  lib/Vend Menu.pm</emphasis>
* Make timeout for menu blank settable (Greg Hanson change).
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-03-09 10:23:47 GMT
Modified:  lib/Vend Dispatch.pm</emphasis>
log message about empty job at catalog level
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-03-02 23:19:19 GMT
Modified:  lib/Vend Form.pm</emphasis>
In the date widget, if the date is blank (0000-00-00), treat a time of
00:00 as blank, not midnight, in the HTML option selection.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-03-02 15:55:43 GMT
Modified:  lib/Vend Config.pm</emphasis>
Correct the default behavior of the new catalog RunDir directive. By the
time this code runs, it's already been expanded into an absolute path so
the checks for whether a user set it or not were not meaningful.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-03-02 12:27:31 GMT
Modified:  lib/Vend Config.pm</emphasis>
* Prevent Interchange crash when SocketFile not in interchange.cfg.

* Add ConfigParseComments as a &quot;warn&quot;, prevents killing virtually every
  catalog in the world when you upgrade. Allow some grace period in
  updating catalog.cfg.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-03-02 07:12:28 GMT
Modified:  lib/Vend Config.pm</emphasis>
Improve support for relocating various Interchange-generated files to
relative paths and add catalog-level RunDir directive.

For example, to move all such files into a var/ hierarchy in traditional
Unix fashion:

In interchange.cfg:
RunDir     var/run
ErrorFile  var/log/error.log
PIDFile    var/run/interchange.pid
SocketFile var/run/socket
IPCsocket  var/run/socket.ipc

In catalog.cfg:
RunDir     var/run
LogFile    var/log/misc.log
ErrorFile  var/log/error.log
SessionDatabase var/session
ScratchDir var/tmp

Still to be dealt with is a chicken-and-egg problem with the global RunDir,
where the interchange.cfg RunDir setting isn't early enough to cover all
settings.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-03-01 22:09:41 GMT
Modified:  .        MANIFEST
Added:     code/Filter date_change_null.filter</emphasis>
Add new date_change_null filter.

This is meant for use with databases such as PostgreSQL that do not accept
invalid dates (the '0000-00-00' used in the date_change filter), but
require a NULL to indicate the absence of a date.

To use, set metadata to use widget &quot;date_blank&quot;, filter &quot;date_change_null&quot;,
and optionally set the default value to &quot;0000-00-00&quot; if you want the
default to be no date, rather than today's date.

Provided by Mark Johnson &lt;mark at endpoint.com&gt; with help from Stefan Hornburg.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: danb
Date: 2006-02-27 20:26:28 GMT
Modified:  lib/Vend Options.pm</emphasis>
* [Fixed] Error type unspecified in one logOnce() call in Options
  - This resulted in the actual error message being dropped and only the &quot;sku&quot;
    argument making it through to the log file.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-23 03:34:53 GMT
Modified:  lib/Vend Config.pm</emphasis>
Allow using an arbitrary subroutine in any package as a GlobalSub,
like this:

GlobalSub my_subname My::Package::some_subname

Also works for a catalog-level Sub, if AllowGlobal is on for the catalog:

Sub my_subname My::Package::some_subname
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: ton
Date: 2006-02-21 12:18:38 GMT
Modified:  lib/Vend Util.pm</emphasis>
  Apply Mike's patch:
  Add display option to [item-price] and [item subtotal]
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: kwalsh
Date: 2006-02-16 21:44:10 GMT
Modified:  lib/Vend Util.pm</emphasis>
    * When display=&quot;text&quot;, make sure that the currency text is always
      displayed before the price value.  The p_cs_precedes value doesn't
      apply to the int_currency_symbol.

    * Make sure that the currency text is separated from the price value,
      just in case the administrator uses something like &quot;GBP&quot;, instead
      of &quot;GBP &quot;, in the int_currency_symbol.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-02-16 16:25:18 GMT
Modified:  lib/Vend Interpolate.pm</emphasis>
* Incompatible change, but unavoidable. Change variable setting determining
  country for tax basis.

  Problem was that MV_COUNTRY_FIELD was determining the country for
  the multistate order check. Since some installations were changing that
  to &quot;tax_country&quot; and manipulating that variable for taxing purposes,
  there was interactin.

  Change MV_COUNTRY_FIELD in Interpolate.pm to MV_COUNTRY_TAX_VAR.

* TODO: make change in UPGRADE.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: ton
Date: 2006-02-15 09:27:54 GMT
Modified:  lib/Vend Util.pm</emphasis>
  Added a feature to the currency tag in order to display
  textual representation of the currency symbol. The so
  called international currency symbol according to the
  ISO 4217 standard.

  Usage:
  1. Add int_currency_symbol entry to the locale table.
  2. Add the display option to tags, like:

     [total-cost display=text]

    Valid values for the display option:
    - text    Displays 'EUR ', 'GBP ', 'USD '  (EUR 125.40)
    - none    No symbol, displays formatted number only. (125.40)
    - symbol  Default behavior (same as calling the tag
          without display option)
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: kwalsh
Date: 2006-02-15 05:39:53 GMT
Modified:  lib/Vend Dispatch.pm</emphasis>
    * If cookies are switched off in the user's browser and the user
      is just switching from a HTTP page to a HTTPS page then there's
      no reason to re-initialise the session.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-02-12 22:25:11 GMT
Modified:  lib/Vend Config.pm</emphasis>
* Add the missing int_currency_symbol key.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-10 15:02:40 GMT
Modified:  lib/Vend Dispatch.pm</emphasis>
Fix bug that allowed code called by DispatchRoutines or CleanupRoutines
to overwrite the routines arrays themselves.

Found and fixed by Frederic Steinfels &lt;fredo at dvdupgrades.ch&gt;.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: kwalsh
Date: 2006-02-03 22:40:58 GMT
Modified:  dist/standard/etc log_transaction</emphasis>
  * Stop processing and return to the checkout if &quot;there was an
    error adding the order to the transaction table.&quot;
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-03 20:16:48 GMT
Modified:  lib/Vend Config.pm</emphasis>
Fix a bug found by Brian Miller (brian at endpoint.com)

When reading an OrderProfile from an external config file,
for instance, etc/profiles.login or similar if there is a comment line
immediately preceding the __NAME__ identifier then the first line of the
profile is commented out. Actually any line preceding the __NAME__ line
will silently be prepended to the first line of the profile, just so
happens a comment (in some of our code) would be the likely offender.

For example:

# following profile confirms user input
__NAME__ Login
  username=required Username had better be filled in.
  password=required Password is required.
__END__

Will result in a profile structure that looks like:

# following profile confirms user input   username=required ...

And the username check will never execute.
</literallayout></para>



<para><literallayout>
<emphasis role='bold'>
Developer: ton
Date: 2006-02-03 16:36:46 GMT
Modified:  lib/Vend Ship.pm</emphasis>
  Added UPS support for countries ouside the US.

  In order to use this functionality one only needs
  to add the following two lines to a UPS shipping
  method in shipping.asc.

  zone_file  products/ship/zone_NL_international.txt
  country_prefix  1

  The zone file 'zone_NLinternational.txt' is TAB delimited and
  should contain entries like:

  low  high  ExpressPlus  Express  ExpressSaver  Standard  Expedited

  &quot;Destination: Belgium (BE). 4-digit code&quot;
  BE:0000  BE:9999  2  2  2  2  -

  &quot;Destination: France (FR). 5-digit code&quot;
  FR:2000  FR:2999  3  3  3  4  -
  FR:3000  FR:7999  3  4  4  5  -
  FR:8000  FR:8999  3  3  3  4  -
  FR:9000  FR:9999  3  4  4  5  -
  FR:1000  FR:1099  3  3  3  4  -

  The values in the postcode range should be prepended with the
  country code. Prepend FR: to postcodes for country France.

  There is no change to the rate tables.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jonc
Date: 2006-02-03 15:58:44 GMT
Modified:  dist/standard catalog.cfg</emphasis>
* add robot_expire plus comment so people know about it.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-02-03 15:34:32 GMT
Modified:  lib/Vend Ship.pm</emphasis>
* Make log message manageable with ErrorDestination.

* Allow a &quot;quiet&quot; shipmode that won't log missing areas.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-03 15:25:20 GMT
Modified:  .        UPGRADE</emphasis>
Note new Perl version requirement.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-01 15:42:04 GMT
Modified:  scripts  interchange.PL</emphasis>
Begin requiring Perl version 5.8.0 or newer.

Allow running under a threaded perl with version 5.8.5 or newer. Still
warn the user that it's not recommended for production.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-01 15:37:48 GMT
Modified:  lib/Vend Interpolate.pm</emphasis>
Add &quot;env&quot; base to conditionals, allowing [if env HTTPS], etc.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: kwalsh
Date: 2006-02-01 14:10:59 GMT
Modified:  dist/standard/products country.txt</emphasis>
    * Added &quot;surf_pp air_pp&quot; to the BA (Bosnia And Herzegowina) country's
      shipmodes and removed the duplicate XB country.

    * Removed XE (Corsica).  It's not an independent country (it's still
      a French colony).  Napoleon Bonaparte was born there (you learn
      something new every day. :-)

    * Removed the duplicate XV (Vatican City) country and put VA into the
      Europe-EC region.

    * Changed the XS (Serbia-Montenegro) country code to CS.

    * Removed XU (Tristan da Cunha), which is a part of SH (St. Helena),
      just like the Ascension island.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-01 03:58:24 GMT
Modified:  .        UPGRADE</emphasis>
Add latest incompatible changes.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-02-01 00:36:05 GMT
Modified:  lib/Vend/Table DBI.pm</emphasis>
Remove unused code found by Stefan Hornburg.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-01-30 22:36:32 GMT
Modified:  .        MANIFEST
Added:     code/OrderCheck always_fail.oc</emphasis>
Add always_fail order check from Mark Johnson (mark at endpoint.com), with
Kevin Walsh's default error message addition. Sync the manifest.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-01-30 17:50:03 GMT
Modified:  lib/Vend/Table Editor.pm</emphasis>
Remove compatible_5_2 pragma, which kept table editor error text
(mistakenly) hidden, as was the case up to Interchange 5.2.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-01-30 17:45:49 GMT
Modified:  lib/Vend Config.pm</emphasis>
Remove configuration directives that were deprecated and generated a
warning at startup time.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-01-30 17:44:11 GMT
Modified:  debian   interchange.cfg
Modified:  dist     interchange.cfg.dist
Modified:  dist/standard catalog.cfg
Modified:  lib/Vend Config.pm</emphasis>
Remove global and catalog directives &quot;ConfigParseComments&quot;. Its &quot;no&quot;
behavior is now the only one. That means that #ifdef, #include, and friends
are now never anything besides comments.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-01-30 17:33:55 GMT
Modified:  .        MANIFEST
Modified:  lib/Vend Data.pm
Removed:   code/SystemTag sql.coretag</emphasis>
Remove antiquated [sql] tag.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: jon
Date: 2006-01-30 17:28:26 GMT
Modified:  code/Filter text2html.filter</emphasis>
XHTMLify the &lt;br&gt; output. Kinda silly since the &lt;p&gt; output doesn't close
the container with &lt;/p&gt;, but oh well.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-24 14:38:36 GMT
Modified:  dist/lib/UI/pages/admin order_view.html</emphasis>
* Display proper state and zip
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: ton
Date: 2006-01-20 17:27:47 GMT
Modified:  dist/standard/pages/query order_detail.html</emphasis>
  Fixed dead links to account.html page.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-01-19 19:43:54 GMT
Modified:  .        MANIFEST
Removed:   code/Widget fck.widget</emphasis>
remove deprecated fck widget as in 5.4 branch
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-18 22:15:59 GMT
Modified:  dist/standard/config pay_cert_redeem.tag</emphasis>
* Fix rounding error that could make total comparisons wrong.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-18 17:47:14 GMT
Modified:  lib/Vend Ship.pm</emphasis>
* Fix thread-safety problem with shipping adder (and potentially other
  things).
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-01-13 20:41:56 GMT
Modified:  dist/standard/templates/components search_box_small</emphasis>
merged changes 1.3 vs 1.3.2.1
+++ 1.3.2.1 +++
closing font tag added as suggested by Steve Graham (icdev at mrlock.com)
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-09 20:20:18 GMT
Modified:  code/UI_Tag flex_select.coretag</emphasis>
* Move filter/label resolution forward so that sorts don't kill them.

* Make flex_group.html more flexible by allowing calls from pages
  besides flex_select.html.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-09 16:10:23 GMT
Modified:  code/UI_Tag add_gpg_key.coretag</emphasis>
* Fix bug with patch supplied by Gert.

* Also remove literal space from regex -- it should be a standard within
  interchange not to use *any* literal whitespace in regular expressions.
  A literal space could be embedded with \0x20 or such, but \s+ should always
  be preferred.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-08 18:29:18 GMT
Modified:  dist/standard/products/ship air_pp.txt surf_pp.txt
Added:     dist/standard/products/ship ems.txt</emphasis>
* Update US Postal rates
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: heins
Date: 2006-01-08 17:26:52 GMT
Modified:  dist/standard/products/ship Priority.txt Book.txt</emphasis>
* Update distributed tables to reflect new US Postal service rates.
</literallayout></para>


<para><literallayout>
<emphasis role='bold'>
Developer: racke
Date: 2006-01-04 19:17:43 GMT
Modified:  code/Widget htmlarea.widget</emphasis>
merged changes 1.6.2.2 vs 1.6.2.3
+++ 1.6.2.3 +++
fix regression with browsers claiming MSIE compatibility
</literallayout></para>

</section>

</article>
